# Wildfire project

This project aims to create predictive models of wildfire using LSTM and VAE techniques. The models are trained and validated with model data (train data and test data), then used for forecasting. Data Assimilation techniques (model data and observation data) are employed for model correction, thereby improving wildfire prediction accuracy.

## Table of contents
1. [Project Overview](#project-overview)
2. [Installation](#installation)
   - [Clone the Repository](#clone-the-repository)
   - [Create the Environment](#creating-environment)
   - [Download Data](#download-data)
     - [Model Data](#model-data)
     - [Satellite Data](#satellite-data)
     - [Link to Trained Models](#link-to-trained-models)
3. [Usage](#usage)
   - [Running the LSTM Model](#objective_1)
   - [Running the VAE Model](#running-the-vae-model)
   - [Data Assimilation](#data-assimilation)

## Installation
### Clone the Repository
```bash
$ git clone https://github.com/ese-msc-2022/ads-wildfire-rush
$ cd ads-wildfire-rush
```

### Creating Environment:
```bash
$ conda env create -f environment.yml
$ conda activate rush
```

### Download Data：

Please download data into the `data` folder. The data have already been preprocessed.

#### Model data
- [Ferguson_fire_train](https://imperiallondon-my.sharepoint.com/personal/rarcucci_ic_ac_uk/_layouts/15/onedrive.aspx?id=%2Fpersonal%2Frarcucci%5Fic%5Fac%5Fuk%2FDocuments%2FBigData%2Ddata%2Dassessment%2FFerguson%5Ffire%5Ftrain%2Ezip&parent=%2Fpersonal%2Frarcucci%5Fic%5Fac%5Fuk%2FDocuments%2FBigData%2Ddata%2Dassessment&ga=1): training data obtained from wildfires simulations
 
- [Ferguson_fire_test](https://imperiallondon-my.sharepoint.com/personal/rarcucci_ic_ac_uk/_layouts/15/onedrive.aspx?id=%2Fpersonal%2Frarcucci%5Fic%5Fac%5Fuk%2FDocuments%2FBigData%2Ddata%2Dassessment%2FFerguson%5Ffire%5Ftest%2Ezip&parent=%2Fpersonal%2Frarcucci%5Fic%5Fac%5Fuk%2FDocuments%2FBigData%2Ddata%2Dassessment&ga=1): similar to Ferguson_fire_train but obtained from different simulations
  
- [Ferguson_fire_background](https://imperiallondon-my.sharepoint.com/personal/rarcucci_ic_ac_uk/_layouts/15/onedrive.aspx?id=%2Fpersonal%2Frarcucci%5Fic%5Fac%5Fuk%2FDocuments%2FBigData%2Ddata%2Dassessment%2FFerguson%5Ffire%5Fbackground%2Ezip&parent=%2Fpersonal%2Frarcucci%5Fic%5Fac%5Fuk%2FDocuments%2FBigData%2Ddata%2Dassessment&ga=1): model data you will use for the data assimilation:
  
#### Satellite data
- [Ferguson_fire_obs](https://imperiallondon-my.sharepoint.com/personal/rarcucci_ic_ac_uk/_layouts/15/onedrive.aspx?ga=1&id=%2Fpersonal%2Frarcucci%5Fic%5Fac%5Fuk%2FDocuments%2FBigData%2Ddata%2Dassessment%2FFerguson%5Ffire%5Fobs%2Enpy&parent=%2Fpersonal%2Frarcucci%5Fic%5Fac%5Fuk%2FDocuments%2FBigData%2Ddata%2Dassessment&p=14): Observation data at different days after ignition (only one trajectory)

#### Link to trained model
Please download trained model into the `model_pth` folder. PCA is used to compress the data in Objective 1. CVAE is used in OBjective 2 and 3
- [PCA](https://1drv.ms/u/s!AreChFyiyKqpfQUUU1T9kpIvYKw?e=u3KcvW)
- [CVAE](https://imperiallondon-my.sharepoint.com/personal/eo322_ic_ac_uk/_layouts/15/onedrive.aspx?id=%2Fpersonal%2Feo322%5Fic%5Fac%5Fuk%2FDocuments%2Fcvae%5Ftrained%5Fmodel%5F10%5Fepochs%2Epth&parent=%2Fpersonal%2Feo322%5Fic%5Fac%5Fuk%2FDocuments&ga=1)

#### Documentation
Wildfire_model_ducumentation.pdf is the documentation of this project generated by Sphinx

## Usage
### Python file
- CVAE.py: module for CVAE model.
- dataloader.py
- filters.py
- models.py
- tests.py

### Jupyter notebook
- OBJECTIVE_1: PCA_LSTM model training, forecasting and mse calculation.
- OBJECTIVE_2: CVAE model training, forecasting and mse calculation.
- OBJECTIVE_3: 
   - data assimilation with predict background data (LSTM) and observation data.
   - data assimilation with predict background data (CVAE) and observation data.
   
Run the OBJECTIVE_1 and OBJECTIVE_2 jupyter notebook to train, save model and predict data (t10, t20, t30, t40)。The preditc data will be saved as predictions_lstm.npy and predictions_cvae.npy as well as observations.npy (t10, t20, t30, t40). 

Use the predict and observation data to perform data assimilation. Notice, data assimilaion must be performed in latent space which means predict and observation data should be compressed using any dimension reduction model we provide including PCA, CAE and CVAE.

